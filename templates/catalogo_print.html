{% extends "base.html" %}

{% block content %}

<div class="container my-4">

  <h1 class="mb-4 text-center">CatÃ¡logo Navarro S.A.</h1>

  {% if marca_sel or familia_sel %}
    <p class="text-center text-muted">
      {% if marca_sel %} Marca: <strong>{{ marca_sel }}</strong> {% endif %}
      {% if marca_sel and familia_sel %} | {% endif %}
      {% if familia_sel %} Familia: <strong>{{ familia_sel }}</strong> {% endif %}
    </p>
  {% endif %}

  {% if productos|length == 0 %}
    <div class="alert alert-warning">
      No se encontraron productos con los filtros seleccionados.
    </div>
  {% endif %}

  <div class="catalogo-grid">
    {% for p in productos %}
      <div class="ficha-producto">
        {% if p.foto_url %}
          <img src="{{ p.foto_url }}" class="img-impresion" alt="{{ p.titulo }}">
        {% endif %}

        <div class="ficha-body">
          <div class="ficha-titulo">
            {{ p.titulo }}
          </div>
          <div class="ficha-precio">
            <span class="label">Precio:</span> {{ p.precio_texto }}
          </div>
        </div>
      </div>
    {% endfor %}
  </div>

</div>

<style>
  body {
    background-color: #f5f5f5;
  }

  .catalogo-grid {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    justify-content: space-between;
  }

  .ficha-producto {
    background: white;
    border-radius: 8px;
    box-shadow: 0 1px 4px rgba(0,0,0,0.1);
    overflow: hidden;
    width: 48%;              /* ðŸ‘‰ 2 fichas por fila */
    margin-bottom: 10px;
    page-break-inside: avoid;
  }

  .img-impresion {
    width: 100%;
    height: 160px;
    object-fit: cover;
    display: block;
  }

  .ficha-body {
    padding: 8px 10px 10px 10px;
  }

  .ficha-titulo {
    font-size: 11pt;
    font-weight: 600;
    margin-bottom: 4px;
  }

  .ficha-precio {
    font-size: 10pt;
  }

  .ficha-precio .label {
    font-weight: 700;
  }

  @media print {
    nav.navbar {
      display: none;  /* ocultar la barra negra arriba */
    }

    body {
      background: white;
      margin: 0;
    }

    .container {
      max-width: 100%;
      padding: 0 10mm;
    }

    .catalogo-grid {
      gap: 6px;
    }

    .ficha-producto {
      width: 48%;
      margin-bottom: 6px;
      box-shadow: none;   /* PDF mÃ¡s limpio */
      border: 1px solid #ddd;
    }
  }
</style>

<script>
  // Abrir diÃ¡logo de imprimir cuando carga
  window.onload = function () {
    window.print();
  };
</script>

{% endblock %}
